<!DOCTYPE html>

<html>
<head>
    <title>Climate Change</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
    <meta name="viewport" content="width=960, initial-scale=1">
    
    <script src="https://cdn.jsdelivr.net/npm/vega@5.16.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4.16.8"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.12.2"></script>

    <style>
        .grids-example{
            font-family: serif;
            text-align: center;
        }
        
        upd_map{
            align-content: center;
        }
        
        slider{
            align-content: center;
        }
    
    </style>
    
</head>

<body>
    <div class = "grids-example">
        <div id="upd_map"></div>  
        <div id="vis_map"></div>
        <div class="slidecontainer" id="slider">
            <input type="range" min="2000" max="2010" value="2005" class="slider" id="myRange">
            <p>Year: <span id="year_display"</p>
        </div>
    </div>

</body>

    
<script type="text/javascript">
    var theYear = '2003'
    var slider = document.getElementById("myRange")
    var output = document.getElementById("year_display")
    
    output.innerHTML = slider.value
    

    
    var v2Spec = {
        $schema: 'https://vega.github.io/schema/vega-lite/v4.json',
        title: 'Change in Temperature',
        width: 800,
        height: 600,
        data:{
            url: 'https://raw.githubusercontent.com/KaneSec/vega_lite/main/3_choropleth_map/js/ne_110m_admin_0_countries.topojson',
            format: {type: 'topojson', feature: 'ne_110m_admin_0_countries'}
        },
        transform: [
            {
                lookup: 'properties.NAME',
                from: {
                    data: {
                        url: 'https://raw.githubusercontent.com/TristYo/FIT3179-Data-Visualisation/master/dtTemp.csv',
                        name: 'myData'
                    },
                    key: 'Country',
                    fields: [theYear]
                }
            }
        ],
        projection: {type: 'equirectangular'},
        mark: {type: 'geoshape'},
        encoding: {
            tooltip: [
                {field: "properties.NAME", type: "nominal", title: "Country"},
                {field: theYear, type: "quantitative", format: ".3"}
                ],
            color: {
                field: theYear,
                type: 'quantitative',
                scale:{
                    type: 'linear',
                    range: ['blue','white','red'],
                    domainMax: 2,
                    domainMin: -2
                }
            }
        }
    }
    vegaEmbed('#upd_map',v2Spec).then(function(result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);
    
    
    slider.oninput = function() {
        output.innerHTML = slider.value;
        theYear = slider.value;
            var v2Spec = {
        $schema: 'https://vega.github.io/schema/vega-lite/v4.json',
        title: 'Change in Temperature',
        width: 800,
        height: 600,
        data:{
            url: 'https://raw.githubusercontent.com/KaneSec/vega_lite/main/3_choropleth_map/js/ne_110m_admin_0_countries.topojson',
            format: {type: 'topojson', feature: 'ne_110m_admin_0_countries'}
        },
        transform: [
            {
                lookup: 'properties.NAME',
                from: {
                    data: {
                        url: 'https://raw.githubusercontent.com/TristYo/FIT3179-Data-Visualisation/master/dtTemp.csv',
                        name: 'myData'
                    },
                    key: 'Country',
                    fields: [theYear]
                }
            }
        ],
        projection: {type: 'equirectangular'},
        mark: {type: 'geoshape'},
        encoding: {
            tooltip: [
                {field: "properties.NAME", type: "nominal", title: "Country"},
                {field: theYear, type: "quantitative", format: ".3"}
                ],
            color: {
                field: theYear,
                type: 'quantitative',
                scale:{
                    type: 'linear',
                    range: ['blue','white','red'],
                    domainMax: 2,
                    domainMin: -2
                }
            }
        }
    }
        vegaEmbed('#upd_map',v2Spec).then(function(result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);
    }
</script>    

</html>